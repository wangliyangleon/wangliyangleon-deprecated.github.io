---
title: 关于lua的那些有（e）趣（xin）的地方
date: Wed Sep 16 22:16:04 JST 2015
layout: post
categories:
  - tech
tags:
  - lua
---
## 语法

* `a = 1 b = a * 2 -- ugly, but valid`
* nil比很多语言（比如C++）中的NULL强大：nil是一种基本数据类型；给一个变量赋值为nil可以将其删除；未定义的变量的默认值为nil
* 变量没有类型，但值有类型
* function作为一个基本数据类型，可以赋值给任何变量，所以`a = print a("Hello World") -- ugly, but valid`
* 只有boolean类型的false和nil才为逻辑假，其他的一切如number类型的0或者string类型的空字符串都是逻辑真
* 进行算术运算时，string会自动转换为number，比如"10" + 1 == 11为真，但是"11" == 11为假，因为这不是算术运算
* 7、类似的，字符串的连接运算符..也会将number转为string，但是如1 .. 2，要在数字后面加空格再加..
* 2 < 15为真，"2" < "15"为假（字典序），为了避免歧义，2 < "15"会报错
* a and b，若a为假，表达式的值为a，否则为b；a or b，若a为真，表达式的值为a，否则为b；所以，c语言中的(a ? b : c)在lua中可以写作(a and b) or c
* not表达式的值仅为true或false
* table的第一个值的索引是1，而不是0，呵呵
* 多个变量同时赋值时，右侧的值会先计算再分别赋值给左边，那么可以通过x, y = y, x非常方便地实现swap
* 多个变量同时赋值时，当值的数量小于变量的数量时，不足的会被赋值为nil，反之，多余的值会被忽略
* break和return必须存在于一个block的最有一句之前，所以会看到大量的do return end。。。
* 当一个函数返回多个值，而该函数的调用用来多变量赋值或作为函数调用的参数或作为table的初始化参数时，如果赋值或调用或初始化列表中只有该函数调用、或该函数调用是列表的最后一个时，使用尽量多的返回值，不足补nil、多余抛弃，其他情况，仅使用第一个返回值，太恶心了。。。
* 当一个函数返回多个值，在调用外面再套层()，强制使用第一个返回值。。。
